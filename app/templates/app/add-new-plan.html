{% extends 'app/base1.html' %}
{% load static %}
{% block content %}

<div class="main-content">
  <div class="page-content">
    <div class="row">
      <div class="col-12">
        <div class="page-title-box d-flex align-items-center justify-content-between">
          <h4 class="mb-sm-0">Add New Plan</h4>
          <div class="page-title-right">
            <ol class="breadcrumb m-0">
              <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
              <li class="breadcrumb-item active">Add New Plan</li>
            </ol>
          </div>
        </div>
      </div>
    </div>

    <div class="container-fluid custom-container py-4" style="margin-top: -20px">
      <div class="card mb-4">
        <div class="card-header">
          <h3 class="card-title mb-0">Membership Details</h3>
        </div>
        <div class="card-body">

          <!-- Messages -->
{% if messages %}
  {% for message in messages %}
    <div class="alert alert-success alert-dismissible fade show" id="successMessage">
      {{ message }}
    </div>
  {% endfor %}
{% endif %}

          <form id="membershipForm" method="post">
            {% csrf_token %}
            <div class="row g-3 align-items-end">
              <!-- Membership Type -->
              <div class="col-12 col-md-6">
                <label class="form-label">Membership Type</label>
                <select
                  class="form-select"
                  name="membership_type"
                  id="membershipType"
                  required
                  onchange="updateDetails()"
                >
                  <option value="" selected disabled>Select Type</option>
                  <option value="1">1 Month</option>
                  <option value="2">2 Months</option>
                  <option value="3">3 Months</option>
                  <option value="6">6 Months</option>
                  <option value="12">1 Year</option>
                  <option value="24">2 Years</option>
                </select>
              </div>

              <!-- Amount -->
              <div class="col-12 col-md-6">
                <label class="form-label">Amount (INR)</label>
                <input
                  type="number"
                  class="form-control"
                  name="amount"
                  id="membershipAmount"
                  readonly
                />
              </div>

              <!-- Duration -->
              <div class="col-12 col-md-6">
                <label class="form-label">Duration</label>
                <input
                  type="text"
                  class="form-control"
                  name="duration"
                  id="membershipDuration"
                  readonly
                />
              </div>

              <!-- Offer -->
              <div class="col-12 col-md-6">
                <label class="form-label">Offer</label>
                <input
                  type="text"
                  class="form-control"
                  name="offer"
                  id="membershipOffer"
                  readonly
                />
              </div>
            </div>

            <!-- Buttons -->
            <div class="d-flex flex-column flex-md-row justify-content-start align-items-center gap-2 mt-4">
              <button type="submit" class="btn btn-outline-primary btn-sm">
                Add Membership
              </button>
            </div>
          </form>

        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function updateDetails() {
    const type = document.getElementById("membershipType").value;
    const amountField = document.getElementById("membershipAmount");
    const durationField = document.getElementById("membershipDuration");
    const offerField = document.getElementById("membershipOffer");

    let amount = 0;
    let duration = "";
    let offer = "";

    switch (type) {
      case "1":
        amount = 699;
        duration = "1 Month";
        offer = "No offer";
        break;
      case "2":
        amount = 1099;
        duration = "2 Months";
        offer = "Save ₹299";
        break;
      case "3":
        amount = 1599;
        duration = "3 Months";
        offer = "Save ₹498";
        break;
      case "6":
        amount = 2799;
        duration = "6 Months";
        offer = "Best Value: Save ₹1295";
        break;
      case "12":
        amount = 4499;
        duration = "1 Year";
        offer = "Save ₹1899";
        break;
      case "24":
        amount = 7999;
        duration = "2 Years";
        offer = "Mega Offer: Save ₹3685";
        break;
    }

    amountField.value = amount;
    durationField.value = duration;
    offerField.value = offer;
  }
</script>
<script>
  // 3 second बाद message auto-hide होगा
  setTimeout(function() {
    let msg = document.getElementById("successMessage");
    if (msg) {
      msg.style.transition = "opacity 0.5s ease";
      msg.style.opacity = "0";
      setTimeout(() => msg.remove(), 500); // पूरी तरह fade होने के बाद remove
    }
  }, 3000);  // 3000 ms = 3 seconds
</script>

{% endblock %}
